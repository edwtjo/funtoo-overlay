From 11e407c3da4a7f11233f6f24d06cc2d79a3e0796 Mon Sep 17 00:00:00 2001
From: Piotr Karbowski <piotr.karbowski@gmail.com>
Date: Tue, 8 Nov 2011 23:34:46 +0100
Subject: [PATCH] Set uname variable to linux if CHOST variable contain linux
 string.

A workaround to broken CHOST parser which intend to put a (for example) 'linux' in uname variable. Lets set uname to 'linux' if CHOST contain *linux* string otherwise revert to the original sed magic.
---
 configure |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/configure b/configure
index 1ac058a..8949a48 100755
--- a/configure
+++ b/configure
@@ -14,8 +14,15 @@
 # an error.
 
 if [ -n "${CHOST}" ]; then
-    uname="`echo "${CHOST}" | sed -e 's/^[^-]*-\([^-]*\)$/\1/' -e 's/^[^-]*-[^-]*-\([^-]*\)$/\1/' -e 's/^[^-]*-[^-]*-\([^-]*\)-.*$/\1/'`"
-    CROSS_PREFIX="${CHOST}-"
+	case "${CHOST}" in
+		*linux*)
+			uname='linux'
+		;;
+		*)
+			uname="$(echo "${CHOST}" | sed -e 's/^[^-]*-\([^-]*\)$/\1/' -e 's/^[^-]*-[^-]*-\([^-]*\)$/\1/' -e 's/^[^-]*-[^-]*-\([^-]*\)-.*$/\1/')"
+		;;
+	esac
+	CROSS_PREFIX="${CHOST}-"
 fi
 
 STATICLIB=libz.a
-- 
1.7.8.rc1

